<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBka80W-Aa9m4NXQ7PD4kmx1xew-lz67l0",
        authDomain: "fastraffic-8b585.firebaseapp.com",
        databaseURL: "https://fastraffic-8b585-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "fastraffic-8b585",
        appId: "1:124682318080:web:f536eacba0881a078683e5"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function handleAuth() {
        const u = document.getElementById('user').value.trim().toLowerCase();
        const p = document.getElementById('pass').value.trim();
        const btn = document.getElementById('mainBtn');

        if (!u || !p) return alert("Nhập đủ tên và mật khẩu!");

        btn.innerText = "Đang kết nối...";
        
        // Gửi dữ liệu và bắt lỗi
        db.ref('users/' + u).set({
            password: p,
            time: new Date().getTime()
        })
        .then(() => {
            alert("THÀNH CÔNG! Dữ liệu đã lên Firebase.");
            btn.innerText = "XÁC NHẬN";
        })
        .catch((error) => {
            // Nếu có lỗi (sai link, sai Rules), nó sẽ hiện ở đây
            alert("LỖI RỒI: " + error.message);
            console.error(error);
            btn.innerText = "THỬ LẠI";
        });
    }
</script>
