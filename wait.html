<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8"><title>Xác minh</title>
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
</head>
<body style="text-align: center; padding-top: 100px; font-family: Arial;">
    <div id="auth-section">
        <h3>Vui lòng xác minh</h3>
        <div class="cf-turnstile" data-sitekey="0x4AAAAAACJ58mUD1xXb3uHV" data-callback="onSuccess"></div>
    </div>
    <div id="status" style="display:none; color: green;">
        <h3>Xong! Đang gửi duyệt... <span id="timer">3</span>s</h3>
    </div>
    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbw6EneO0xTtBpD5pTANB1mtm51JEYWc0aR4DAZ_1vtIBK2bOJk5B0xf-7E9XIIsCYDc/exec';
        const target = "https://google.com"; // Thay link rút gọn của bạn vào đây
        function onSuccess() {
            document.getElementById("auth-section").style.display = "none";
            document.getElementById("status").style.display = "block";
            const user = localStorage.getItem("username");
            const id = new URLSearchParams(window.location.search).get("id");
            
            fetch(scriptURL, { method: 'POST', mode: 'no-cors', body: JSON.stringify({ action: "task", username: user, id: id }) });

            let time = 3;
            setInterval(() => {
                time--; document.getElementById("timer").innerText = time;
                if(time <= 0) {
                    document.cookie = `done_${id}=true; max-age=86400; path=/`;
                    window.location.href = target;
                }
            }, 1000);
        }
    </script>
</body>
</html>






