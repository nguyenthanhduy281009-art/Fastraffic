<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FASTRAFFIC - Trang ch·ªß</title>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; margin: 0; padding-bottom: 80px; }
        .header { background: white; padding: 20px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .balance-card { background: white; margin: 15px; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .balance-amount { font-size: 28px; color: #2ecc71; font-weight: bold; margin: 10px 0; }
        
        /* Menu ƒëi·ªÅu h∆∞·ªõng nguy√™n b·∫£n */
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: white; display: flex; justify-content: space-around; padding: 10px 0; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); border-top-left-radius: 20px; border-top-right-radius: 20px; }
        .nav-item { text-align: center; color: #666; text-decoration: none; font-size: 12px; flex: 1; }
        .nav-item i { font-size: 20px; display: block; margin-bottom: 4px; }
        .nav-item.active { color: #e94560; }

        .content-section { padding: 15px; display: none; }
        .content-section.active { display: block; }
        
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; font-size: 14px; }
        .status-done { color: #27ae60; font-weight: bold; }
        .status-pending { color: #f39c12; }
    </style>
</head>
<body>

    <div class="header">
        <h2 style="margin:0; color:#e94560;">FASTRAFFIC</h2>
    </div>

    <div id="home" class="content-section active">
        <div class="balance-card">
            <p style="margin:0; color:#666;">S·ªë d∆∞ hi·ªán t·∫°i</p>
            <div class="balance-amount" id="user-money">0ƒë</div>
        </div>
        <div style="padding:10px; background:white; border-radius:10px; margin:15px;">
            <p>üëã Ch√†o m·ª´ng b·∫°n quay tr·ªü l·∫°i!</p>
            <p style="font-size:13px; color:#666;">Ho√†n th√†nh nhi·ªám v·ª• ƒë·ªÉ ki·∫øm th√™m thu nh·∫≠p ngay nh√©.</p>
        </div>
    </div>

    <div id="history" class="content-section">
        <h3 style="margin-left:15px;">L·ªãch s·ª≠ giao d·ªãch</h3>
        <table>
            <thead><tr><th>Th·ªùi gian</th><th>S·ªë ti·ªÅn</th><th>Tr·∫°ng th√°i</th></tr></thead>
            <tbody id="history-list"></tbody>
        </table>
    </div>

    <div id="rules" class="content-section">
        <h3 style="margin-left:15px;">Quy ƒë·ªãnh h·ªá th·ªëng</h3>
        <div style="background:white; padding:15px; margin:15px; border-radius:10px;">
            <p>1. Kh√¥ng gian l·∫≠n nhi·ªám v·ª•.</p>
            <p>2. R√∫t ti·ªÅn t·ªëi thi·ªÉu 20.000ƒë.</p>
            <p>3. Th·ªùi gian duy·ªát t·ª´ 5-30 ph√∫t.</p>
        </div>
    </div>

    <div id="withdraw" class="content-section">
        <h3 style="margin-left:15px;">R√∫t ti·ªÅn</h3>
        <div style="background:white; padding:15px; margin:15px; border-radius:10px;">
            <p>T√≠nh nƒÉng r√∫t ti·ªÅn ƒëang ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng.</p>
            </div>
    </div>

    <div class="bottom-nav">
        <a href="javascript:void(0)" class="nav-item active" onclick="showTab('home', this)"><i class="fas fa-home"></i>Trang ch·ªß</a>
        <a href="javascript:void(0)" class="nav-item" onclick="showTab('history', this)"><i class="fas fa-history"></i>L·ªãch s·ª≠</a>
        <a href="javascript:void(0)" class="nav-item" onclick="showTab('rules', this)"><i class="fas fa-book"></i>Quy ƒë·ªãnh</a>
        <a href="javascript:void(0)" class="nav-item" onclick="showTab('withdraw', this)"><i class="fas fa-wallet"></i>R√∫t ti·ªÅn</a>
    </div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBka80W-Aa9m4NXQ7PD4kmx1xew-lz67l0",
        authDomain: "fastraffic-8b585.firebaseapp.com",
        projectId: "fastraffic-8b585",
        databaseURL: "https://fastraffic-8b585-default-rtdb.asia-southeast1.firebasedatabase.app"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // H√†m chuy·ªÉn ƒë·ªïi Tab
    function showTab(tabId, el) {
        document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        el.classList.add('active');
    }

    firebase.auth().onAuthStateChanged(user => {
        if (user) {
            const uid = user.email.replace(/\./g, '_');
            // C·∫≠p nh·∫≠t s·ªë d∆∞
            db.ref(`users/${uid}/money`).on('value', s => {
                document.getElementById('user-money').innerText = (s.val() || 0).toLocaleString() + "ƒë";
            });
            // L·ªãch s·ª≠
            db.ref(`history/${uid}`).on('value', s => {
                const list = document.getElementById('history-list');
                list.innerHTML = '';
                if(s.exists()){
                    Object.values(s.val()).reverse().forEach(item => {
                        let st = item.status === 'done' ? 'Th√†nh c√¥ng' : (item.status === 'pending' ? 'Ch·ªù duy·ªát' : 'ƒê√£ h·ªßy');
                        list.innerHTML += `<tr><td><small>${item.time||''}</small></td><td>${item.amount.toLocaleString()}ƒë</td><td class="status-${item.status}">${st}</td></tr>`;
                    });
                }
            });
        } else { location.href = 'login.html'; }
    });
</script>
</body>
</html>
